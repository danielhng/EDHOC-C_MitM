#xubuntu2210

##In case libcbor was already installed, try first
## apt-get remove libcbor-dev
## apt-get remove libcbor0.10

##In case of compilation problems, try first:
## sudo apt-get install build-essential
## then, sudo apt-get install cmake


echo "1. clone the main repo"
git clone https://github.com/danielhng/EDHOC-C_MitM
echo "installing main dependencies"
echo "2. openssl, manually" 
mkdir openssl
cd openssl/
wget https://www.openssl.org/source/openssl-1.1.1m.tar.gz
tar zxvf openssl-1.1.1m.tar.gz 
cd openssl-1.1.1m/
./config --prefix=/opt/openssl --openssldir=/opt/openssl/ssl
make
sudo make install
echo "3. libb64, using apt" 
sudo apt-get install libb64-dev
sudo apt-get install libb64-0d
echo "4. libcbor, from https://github.com/alexkrontiris/EDHOC-C" 
cd ..
ls
cd libcbor/
git clone https://github.com/alexkrontiris/libcbor.git
sudo apt-get install cmake
cmake -DCMAKE_BUILD_TYPE=Release libcbor
make
cd ..
cd EDHOC-C/
ln -s ../libcbor/
make clean
./make.sh
export LD_LIBRARY_PATH=$HOME/EDHOC-C_MitM/openssl/openssl-1.1.1m/:$LD_LIBRARY_PATH
./edhoc-server 
./edhoc-MitM 
./edhoc-client
